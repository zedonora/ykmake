# 작업 2: IdeasGPT 테이블 스키마 정의 및 데이터 로딩/표시

## 단계

1.  **Supabase `ideas_gpt` 테이블 스키마 정의:**
    *   Supabase Studio 또는 SQL 편집기를 사용하여 `ideas_gpt` 테이블을 생성합니다. 필요한 컬럼(예: `id`, `created_at`, `title`, `description`, `category`, `user_id`)을 정의하고 RLS 정책을 설정합니다.

    !!!sql
    -- ideas_gpt 테이블 생성 예시
    CREATE TABLE ideas_gpt (
      id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
      created_at TIMESTAMPTZ DEFAULT now() NOT NULL,
      title TEXT NOT NULL,
      description TEXT,
      category TEXT, -- 아이디어 분류 (선택 사항)
      user_id UUID REFERENCES auth.users(id) ON DELETE SET NULL -- 작성자 삭제 시 아이디어는 유지
    );

    -- RLS 정책 활성화
    ALTER TABLE ideas_gpt ENABLE ROW LEVEL SECURITY;

    -- 정책 예시: 모든 사용자가 아이디어 읽기 가능
    CREATE POLICY "Allow read access to everyone" ON ideas_gpt
    FOR SELECT USING (true);

    -- 정책 예시: 인증된 사용자만 아이디어 생성 가능
    CREATE POLICY "Allow insert for authenticated users" ON ideas_gpt
    FOR INSERT WITH CHECK (auth.role() = 'authenticated');
    !!!

2.  **아이디어 목록 페이지 라우트 생성:**
    *   `app/routes/ideas.tsx` 파일을 생성합니다.

    !!!bash
    touch app/routes/ideas.tsx
    !!!

3.  **`ideas.tsx` 라우트에서 데이터 로딩 구현:**
    *   `loader` 함수를 사용하여 Supabase에서 `ideas_gpt` 데이터를 가져옵니다.

    !!!typescript
    // app/routes/ideas.tsx
    import { type LoaderFunctionArgs, type MetaFunction } from "@remix-run/node";
    import { useLoaderData } from "@remix-run/react";
    import { supabaseAdmin } from "~/lib/supabase.server";

    export const meta: MetaFunction = () => {
      return [{ title: "YkMake | 아이디어" }];
    };

    export const loader = async ({ request }: LoaderFunctionArgs) => {
      const { data: ideas, error } = await supabaseAdmin
        .from("ideas_gpt")
        .select("id, title, description, category, created_at")
        .order("created_at", { ascending: false });

      if (error) {
        console.error("Error fetching ideas:", error);
        throw new Response("Error loading ideas", { status: 500 });
      }

      return Response.json({ ideas });
    };

    export default function IdeasPage() {
      const { ideas } = useLoaderData<typeof loader>();

      return (
        <div className="container mx-auto px-4 py-8">
          <h1 className="text-3xl font-bold mb-6">아이디어 목록 (IdeasGPT)</h1>
          {ideas?.length > 0 ? (
            <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
              {ideas.map((idea) => (
                <div key={idea.id} className="border rounded-lg p-4 shadow-sm">
                  <h2 className="text-xl font-semibold mb-2">{idea.title}</h2>
                  {idea.category && (
                    <span className="inline-block bg-secondary text-secondary-foreground text-xs font-medium mr-2 px-2.5 py-0.5 rounded mb-2">
                      {idea.category}
                    </span>
                  )}
                  <p className="text-muted-foreground text-sm mb-2">{idea.description}</p>
                  <p className="text-xs text-gray-500">
                    {new Date(idea.created_at).toLocaleDateString()}
                  </p>
                </div>
              ))}
            </div>
          ) : (
            <p>아직 등록된 아이디어가 없습니다.</p>
          )}
        </div>
      );
    }
    !!!

## 완료 확인

*   Supabase 프로젝트에 `ideas_gpt` 테이블이 정상적으로 생성되었는지 확인합니다.
*   RLS 정책이 올바르게 설정되었는지 확인합니다.
*   `app/routes/ideas.tsx` 파일이 생성되고 위 코드가 포함되었는지 확인합니다.
*   애플리케이션을 실행하고 `/ideas` 경로로 접속했을 때, Supabase에 저장된 아이디어 목록이 카드 형태로 정상적으로 표시되는지 확인합니다.
*   오류 발생 시 서버 콘솔 로그를 확인합니다. 