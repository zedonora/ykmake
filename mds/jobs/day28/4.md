# 정적 에셋 처리 및 CDN 설정 검토

운영 환경에서 애플리케이션의 정적 에셋(CSS, JavaScript 번들, 이미지, 폰트 등)이 효율적으로 제공되고 캐싱되는지, 그리고 CDN(콘텐츠 전송 네트워크)이 올바르게 활용되고 있는지 확인하는 과정입니다. 이는 웹사이트 로딩 성능과 사용자 경험에 직접적인 영향을 미칩니다.

## 1. 정적 에셋 빌드 결과 확인

-   운영 빌드(`npm run build` 또는 `yarn build`) 후 생성된 빌드 출력 디렉토리(예: `build/client/`, `public/build/`)를 확인합니다.
-   **에셋 파일 존재 확인:** CSS, JavaScript 번들, 이미지, 폰트 등 필요한 정적 에셋 파일들이 올바른 위치에 생성되었는지 확인합니다.
-   **해시 기반 파일 이름:** 빌드된 CSS 및 JavaScript 파일 이름에 고유한 해시값(예: `entry.client-a1b2c3d4.js`, `styles-e5f6g7h8.css`)이 포함되어 있는지 확인합니다. 이는 브라우저 및 CDN 캐싱을 효과적으로 관리하기 위한 중요한 기법(캐시 버스팅)입니다. Remix + Vite 조합에서는 기본적으로 활성화됩니다.

## 2. 정적 에셋 제공 방식 확인

-   애플리케이션이 배포된 운영 환경에서 정적 에셋이 어떻게 사용자에게 제공되는지 확인합니다.
-   **호스팅 플랫폼 확인:**
    -   **Vercel, Netlify 등:** 이러한 플랫폼은 일반적으로 빌드된 정적 에셋을 자동으로 감지하여 자체 CDN을 통해 최적으로 제공합니다. 별도 설정 없이도 CDN의 이점을 누릴 수 있습니다.
    -   **직접 서버 운영 (Node.js 서버):**
        -   Express와 같은 프레임워크를 사용하는 경우, 정적 파일 제공 미들웨어(예: `express.static`)가 `public` 또는 빌드 출력 디렉토리를 가리키도록 올바르게 설정되어 있는지 확인합니다.
        -   Remix의 경우, 프로덕션 서버 설정(`server.js` 또는 플랫폼 어댑터)에서 정적 에셋 제공 관련 부분을 확인합니다. Vite 통합 이후에는 일반적으로 별도 설정이 크게 필요하지 않을 수 있습니다.
    -   **Nginx/Apache 등 리버스 프록시 사용:** 웹 서버 설정에서 정적 에셋 요청을 애플리케이션 서버로 전달하지 않고 직접 처리하도록 설정되어 있는지 확인합니다. (`location` 블록 설정 등)

## 3. CDN 설정 검토 (해당되는 경우)

-   별도의 CDN 서비스(Cloudflare, AWS CloudFront, Akamai 등)를 사용하는 경우, 해당 CDN 설정을 검토합니다.
-   **오리진(Origin) 서버 설정:** CDN이 정적 에셋을 가져올 원본 서버(애플리케이션 서버 또는 스토리지) 주소가 올바르게 설정되어 있는지 확인합니다.
-   **캐싱 규칙 (Caching Rules):**
    -   CSS, JS, 이미지, 폰트 등 에셋 유형별로 적절한 캐시 만료 시간(TTL - Time To Live)이 설정되어 있는지 확인합니다.
    -   해시 기반 파일 이름을 사용하는 경우, 해당 에셋들은 내용이 변경되지 않는 한 영구적으로 캐시되도록 긴 TTL(예: 1년)을 설정하는 것이 일반적입니다 (`Cache-Control: public, max-age=31536000, immutable`).
    -   HTML 파일은 동적인 콘텐츠일 수 있으므로 일반적으로 캐시하지 않거나 짧은 TTL을 설정합니다 (`Cache-Control: no-cache`, `private, max-age=0` 등).
-   **압축 설정 (Gzip/Brotli):** CDN 레벨에서 압축 기능이 활성화되어 에셋을 압축하여 전송하는지 확인합니다 (운영 빌드 최적화 검토의 압축 확인과 유사).
-   **기타 최적화 기능:** 이미지 최적화, HTTP/2 또는 HTTP/3 지원 등 CDN이 제공하는 추가 성능 최적화 기능이 활성화되어 있는지 확인합니다.

## 4. 브라우저 캐싱 헤더 확인

-   배포된 운영 환경에서 브라우저 개발자 도구(F12)를 열고 `Network` 탭을 확인합니다.
-   CSS, JS, 이미지 등 정적 에셋 요청을 선택하고 `Response Headers` 섹션을 확인합니다.
-   **`Cache-Control` 헤더:**
    -   예상되는 캐싱 지시문(예: `public, max-age=31536000, immutable`)이 올바르게 설정되어 있는지 확인합니다. `max-age`는 초 단위의 캐시 유효 기간입니다.
    -   `immutable` 지시문은 파일 내용이 절대 변경되지 않음을 나타내어, 브라우저가 유효성 검사 요청 없이 캐시된 버전을 사용하도록 합니다 (해시 파일명과 함께 사용 시 효과적).
-   **`ETag` 또는 `Last-Modified` 헤더:** 캐시 유효성 검사에 사용될 수 있는 헤더가 존재하는지 확인합니다.
-   **반복 방문 테스트:** 페이지를 새로고침하거나 다른 페이지로 이동 후 다시 돌아왔을 때, 캐시된 에셋은 네트워크 요청 없이 (상태 코드 `200 (from disk cache)` 또는 `304 Not Modified`) 빠르게 로드되는지 확인합니다.

## 5. 사용자 정의 폰트/이미지 로딩 최적화 검토

-   웹 폰트나 고용량 이미지를 사용하는 경우, 로딩 성능에 미치는 영향을 검토합니다.
-   **웹 폰트:**
    -   `woff2` 포맷을 우선적으로 사용하는지 확인합니다 (압축률이 가장 좋음).
    -   `font-display: swap;` CSS 속성을 사용하여 폰트 로딩 중 텍스트가 먼저 보이도록 설정했는지 확인합니다 (FOIT 방지).
    -   필요한 문자만 포함하는 서브셋 폰트를 사용하는 것을 고려합니다.
-   **이미지:**
    -   적절한 크기로 리사이즈된 이미지를 사용하는지 확인합니다 (원본 고해상도 이미지를 그대로 사용 X).
    -   WebP, AVIF 등 최신 이미지 포맷을 사용하여 용량을 줄이는 것을 고려합니다 (`<picture>` 태그 사용).
    -   Lazy loading (`loading=\"lazy\"` 속성)을 적용하여 화면에 보이지 않는 이미지는 나중에 로드하도록 설정했는지 확인합니다.

## 완료 확인

1.  운영 빌드 결과물에 정적 에셋(CSS, JS, 이미지 등)이 포함되어 있으며, CSS/JS 파일명에 해시가 적용되었습니다.
2.  정적 에셋이 호스팅 플랫폼의 CDN 또는 설정된 CDN을 통해 효율적으로 제공되고 있음을 확인했습니다.
3.  (CDN 사용 시) CDN 캐싱 규칙이 에셋 유형별로 적절하게 설정되었습니다 (특히 해시 파일명 에셋에 대한 긴 TTL).
4.  브라우저 개발자 도구를 통해 정적 에셋 응답 헤더(`Cache-Control`)가 올바르게 설정되어 브라우저 캐싱이 효과적으로 동작함을 확인했습니다.
5.  반복 방문 시 캐시된 에셋이 빠르게 로드됨을 확인했습니다.
6.  (해당 시) 웹 폰트 및 이미지 로딩에 대한 최적화 방안(포맷, `font-display`, lazy loading 등)이 적용되었는지 검토했습니다. 