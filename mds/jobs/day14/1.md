# Day 14 - 작업 1: 사용자 프로필 페이지 UI 구현\n\n특정 사용자의 프로필 정보를 보여주는 페이지의 UI를 구현합니다. 이 페이지는 동적 경로(`app/routes/users.$userId.tsx`)를 사용하여 특정 `userId`에 해당하는 사용자의 정보를 표시합니다.\n\n## 목표\n\n*   사용자 ID를 기반으로 동적 라우트를 생성합니다 (`/users/:userId`).\n*   `loader` 함수를 구현하여 URL의 `userId` 파라미터를 이용해 해당 사용자의 프로필 정보를 `profiles` 테이블에서 가져옵니다.\n*   가져온 프로필 정보(아바타, 사용자 이름, 가입일 등)를 표시하는 UI를 Shadcn UI 컴포넌트를 사용하여 구성합니다.\n*   프로필 정보가 없거나 로드 중 오류 발생 시 적절한 처리(예: 404 페이지)를 합니다.\n\n## 작업 단계\n\n### 1. 동적 라우트 파일 생성 (`app/routes/users.$userId.tsx`)\n\n1.  `app/routes/` 디렉토리에 `users.$userId.tsx` 파일을 생성합니다. `$` 접두사는 이 부분이 동적 세그먼트임을 나타냅니다.\n\n### 2. 프로필 데이터 로딩 (`loader` 함수 구현)\n\n1.  **`loader` 함수 정의**: `users.$userId.tsx` 파일 내에 `loader` 함수를 export 합니다.\n2.  **`userId` 파라미터 가져오기**: `LoaderFunctionArgs`의 `params` 객체에서 `userId`를 추출합니다. `userId`가 없거나 유효하지 않으면 404 응답을 반환합니다.\n3.  **데이터베이스 조회**: Supabase 클라이언트를 사용하여 `profiles` 테이블에서 `params.userId`와 일치하는 `id`를 가진 프로필 데이터를 `select` 합니다.\n    *   필요한 컬럼(예: `username`, `avatar_url`, `created_at`)을 명시적으로 선택합니다. 이메일(`email`)과 같은 민감 정보는 필요하지 않다면 포함하지 않습니다.\n    *   `.single()` 메서드를 사용하여 단일 레코드를 가져옵니다.\n4.  **오류 처리**: 데이터 조회 중 오류가 발생하거나 해당 `userId`의 프로필이 존재하지 않으면 404 응답을 throw 합니다.\n5.  **데이터 반환**: 성공적으로 프로필 데이터를 가져오면 `json` 함수를 사용하여 클라이언트로 반환합니다.\n\n    ```typescript\n    // 예시: app/routes/users.$userId.tsx 내 loader 함수\n    import { LoaderFunctionArgs, json } from \"@remix-run/node\";\n    import { createServerClient } from \"~/lib/supabase.server\";\n    import { z } from \"zod\";\n\n    // userId가 UUID 형식인지 검증하는 스키마\n    const ParamsSchema = z.object({\n      userId: z.string().uuid(\"Invalid user ID format\"),\n    });\n\n    export async function loader({ params, request, context }: LoaderFunctionArgs) {\n      const result = ParamsSchema.safeParse(params);\n\n      if (!result.success) {\n        throw new Response(\"Invalid User ID\", { status: 400 });\n      }\n      const { userId } = result.data;\n\n      const { supabase } = await createServerClient(request, context);\n\n      // profiles 테이블에서 필요한 정보만 선택\n      const { data: profile, error } = await supabase\n        .from(\"profiles\")\n        .select(\"id, username, avatar_url, created_at\") // email 등 민감 정보 제외\n        .eq(\"id\", userId)\n        .single();\n\n      if (error || !profile) {\n        // 오류 발생 또는 프로필 정보가 없을 경우 404 반환\n        console.error(\"Error fetching profile or profile not found:\", error);\n        throw new Response(\"User Profile Not Found\", { status: 404 });\n      }\n\n      // profile 데이터를 json 형태로 반환\n      return json({ profile });\n    }\n    ```\n\n### 3. 프로필 UI 렌더링\n\n1.  **데이터 가져오기**: `useLoaderData()` 훅을 사용하여 `loader` 함수가 반환한 `profile` 데이터를 컴포넌트 내에서 가져옵니다.\n2.  **UI 컴포넌트 구성**: Shadcn UI 컴포넌트 (예: `Card`, `Avatar`, `Heading`, `Text`)를 사용하여 프로필 정보를 시각적으로 표현합니다.\n    *   `Avatar`: `profile.avatar_url`을 사용하여 사용자 아바타를 표시합니다. 아바타 URL이 없을 경우 기본 이미지를 표시합니다.\n    *   `Card`: 프로필 정보를 감싸는 컨테이너로 사용할 수 있습니다. `CardHeader`, `CardContent` 등을 활용합니다.\n    *   사용자 이름 (`profile.username`)을 눈에 띄게 표시합니다.\n    *   가입일 (`profile.created_at`) 등 추가 정보를 표시합니다. 날짜 형식은 `date-fns` 등의 라이브러리를 사용하여 보기 좋게 포맷합니다.\n\n    ```typescript\n    // 예시: app/routes/users.$userId.tsx 내 UI 컴포넌트\n    import { useLoaderData } from \"@remix-run/react\";\n    import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\";\n    import { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\";\n    import { format } from 'date-fns';\n    import { ko } from 'date-fns/locale';\n    // loader 함수에서 반환된 데이터 타입 정의 (필요시)\n    // import type { loader } from \"./users.$userId\";\n\n    export default function UserProfilePage() {\n      // loader에서 반환된 profile 데이터 사용\n      const { profile } = useLoaderData<typeof loader>();\n\n      // 사용자 이름의 첫 글자를 Fallback으로 사용\n      const fallbackInitial = profile.username ? profile.username.charAt(0).toUpperCase() : '?';\n\n      return (\n        <div className=\"container mx-auto p-4 max-w-2xl\">\n          <Card>\n            <CardHeader className=\"items-center text-center\">\n              <Avatar className=\"w-24 h-24 mb-4\">\n                <AvatarImage src={profile.avatar_url ?? undefined} alt={profile.username ?? 'User avatar'} />\n                <AvatarFallback>{fallbackInitial}</AvatarFallback>\n              </Avatar>\n              <CardTitle className=\"text-2xl\">{profile.username ?? 'Unknown User'}</CardTitle>\n            </CardHeader>\n            <CardContent className=\"text-center space-y-2\">\n              <p className=\"text-sm text-muted-foreground\">\n                가입일: {format(new Date(profile.created_at), 'yyyy년 MM월 dd일', { locale: ko })}\n              </p>\n              {/* 필요에 따라 다른 프로필 정보 추가 */}\n              {/* 예: <p>Email: {profile.email}</p> - 공개 설정된 경우에만 */}\n            </CardContent>\n            {/* 프로필 수정 버튼 (다음 작업에서 구현, 본인 프로필일 때만 표시) */}\n            {/* 작성 글/댓글 목록 (다음 작업에서 구현) */}\n          </Card>\n        </div>\n      );\n    }\n    ```\n\n## 예상 결과\n\n*   브라우저에서 `/users/<사용자_UUID>` 형태의 URL로 접속하면 해당 사용자의 프로필 페이지가 표시됩니다.\n*   페이지에는 사용자의 아바타, 사용자 이름, 가입일 등의 정보가 표시됩니다.\n*   존재하지 않는 `userId`로 접근하거나 데이터 로딩에 실패하면 404 오류 페이지가 표시됩니다.\n\n## 체크리스트\n\n*   [ ] `app/routes/users.$userId.tsx` 파일이 생성되었는가?\n*   [ ] `loader` 함수가 URL의 `userId`를 사용하여 `profiles` 테이블에서 데이터를 올바르게 조회하는가?\n*   [ ] 프로필 정보가 없거나 오류 발생 시 404 응답을 반환하는가?\n*   [ ] `useLoaderData`를 통해 프로필 데이터를 컴포넌트에서 사용할 수 있는가?\n*   [ ] `Avatar`, `Card` 등 Shadcn UI 컴포넌트를 사용하여 프로필 정보(아바타, 이름, 가입일 등)가 UI에 표시되는가?\n*   [ ] 아바타 이미지가 없을 때 Fallback 처리가 되는가?\n``` 