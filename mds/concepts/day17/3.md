# Day 17 - 개념 3: 사용자별 데이터 조회 및 알림 UI/UX

알림 페이지는 사용자에게 개인화된 정보를 제공하는 중요한 접점입니다. 효과적인 알림 페이지 UI/UX를 위한 주요 개념들을 알아봅니다.

## 1. 사용자별 데이터 조회 (Loader 및 RLS)

*   **개념**: 로그인한 사용자에게 관련된 데이터(여기서는 알림)만 필터링하여 보여주는 것입니다. 보안과 개인화의 핵심 요소입니다.
*   **Remix `loader` 함수**:
    *   서버 사이드에서 실행되므로, 사용자 인증 상태를 확인하고 해당 사용자의 데이터를 안전하게 조회하기에 적합합니다.
    *   `createServerClient` (또는 유사 유틸리티)를 사용하여 요청 헤더에서 세션 정보를 읽어 현재 로그인된 사용자의 ID (`user.id`)를 얻습니다.
    *   Supabase 클라이언트의 `.eq("user_id", user.id)` 와 같은 필터 조건을 사용하여 `notifications` 테이블에서 현재 사용자의 알림만 조회합니다.
*   **Row Level Security (RLS)**:
    *   데이터베이스 레벨에서 접근 제어를 강제합니다. `loader` 함수에서 필터링을 누락하더라도, RLS 정책 (`USING (auth.uid() = user_id)`)이 적용되어 있으면 사용자는 자신의 데이터만 조회할 수 있습니다.
    *   **보안 강화**: RLS는 클라이언트 측 코드나 서버 로직의 실수로 인한 데이터 노출 위험을 크게 줄여줍니다. `loader`에서의 필터링과 RLS를 함께 사용하는 것이 가장 안전합니다.

## 2. 알림 목록 표시 UI/UX 고려사항

*   **정보의 명확성**: 각 알림 항목은 사용자가 어떤 이벤트에 대한 알림인지 명확하게 인지할 수 있도록 충분한 정보를 제공해야 합니다.
    *   **알림 메시지 (`message`)**: 핵심 내용을 간결하게 전달합니다. (예: "OOO님이 회원님의 게시글에 댓글을 남겼습니다.")
    *   **관련 사용자 (`actor`)**: 알림을 발생시킨 사용자의 아바타나 사용자명을 표시하면 맥락 파악에 도움이 됩니다. (`actor_id`를 이용해 `profiles` 테이블 JOIN)
    *   **발생 시간 (`created_at`)**: "5분 전", "어제" 와 같이 상대적인 시간(`formatDistanceToNow` 등 활용)으로 표시하면 가독성이 좋습니다.
    *   **관련 콘텐츠 링크 (`link`)**: 알림 클릭 시 관련 게시글, 댓글 위치, 제품 페이지 등으로 바로 이동할 수 있도록 명확한 링크를 제공해야 합니다.
*   **읽음/읽지 않음 상태 구분**: 사용자가 어떤 알림을 확인했는지 쉽게 구분할 수 있어야 합니다.
    *   **시각적 강조**: 읽지 않은 알림은 배경색, 굵은 텍스트, 작은 점(Indicator) 등으로 시각적으로 다르게 표시합니다. (`read` 필드 값에 따라 조건부 스타일링 적용)
*   **정렬**: 일반적으로 최신 알림이 가장 중요하므로, `created_at` 기준으로 내림차순 정렬하여 보여주는 것이 좋습니다.
*   **페이지네이션**: 알림이 많아질 경우를 대비하여 페이지네이션을 구현하면 성능을 개선하고 사용자가 목록을 탐색하기 용이해집니다.
*   **액션**: 사용자가 알림과 상호작용할 수 있는 기능을 제공합니다.
    *   **개별 알림 읽음 처리**: 알림 항목을 클릭했을 때 해당 알림을 읽음 상태로 변경합니다. (다음 작업에서 구현)
    *   **모두 읽음 처리**: 버튼 클릭으로 모든 읽지 않은 알림을 한 번에 읽음 처리하는 기능을 제공하면 편리합니다. (다음 작업에서 구현)
    *   **(선택) 알림 삭제**: 사용자가 필요 없는 알림을 직접 삭제하는 기능을 제공할 수 있습니다.

## 3. 컴포넌트 기반 UI 개발 (Shadcn UI 활용 예시)

*   **재사용성 및 일관성**: 미리 정의된 UI 컴포넌트(예: Shadcn UI)를 활용하면 개발 속도를 높이고 애플리케이션 전체의 디자인 일관성을 유지하는 데 도움이 됩니다.
*   **활용 컴포넌트 예시**:
    *   **`Card`**: 각 알림 항목을 감싸는 컨테이너로 사용합니다.
    *   **`Avatar`**: 알림 발생 사용자(actor)의 프로필 이미지를 표시합니다.
    *   **`Badge`**: 알림 유형이나 상태(예: 'New')를 표시하는 데 사용할 수 있습니다.
    *   **`Link` (Remix)**: 알림 클릭 시 이동할 경로를 연결합니다.
*   **조건부 스타일링**: `clsx` 라이브러리나 삼항 연산자 등을 사용하여 `read` 상태에 따라 다른 CSS 클래스를 적용하여 읽음/읽지 않음 상태를 시각적으로 구분합니다.

사용자 중심의 명확하고 효율적인 UI/UX 설계는 알림 시스템의 가치를 높이는 중요한 요소입니다. 