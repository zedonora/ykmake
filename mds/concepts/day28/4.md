# Day 28: 정적 에셋 처리 및 CDN 개념

## 1. 정적 에셋 (Static Assets) 이란?

정적 에셋은 웹 애플리케이션에서 내용이 자주 변경되지 않고, 사용자 요청에 따라 서버에서 별도의 처리 없이 그대로 제공되는 파일들을 의미합니다. 대표적인 예는 다음과 같습니다:

-   **CSS 파일:** 웹 페이지의 스타일과 레이아웃을 정의합니다.
-   **JavaScript 파일:** 웹 페이지의 동적인 기능과 상호작용을 구현합니다. (운영 빌드된 번들 파일)
-   **이미지 파일:** 로고, 아이콘, 사진 등 (JPG, PNG, GIF, SVG, WebP, AVIF 등)
-   **폰트 파일:** 웹 페이지의 텍스트 렌더링에 사용되는 글꼴 파일 (WOFF, WOFF2 등)
-   **기타:** 비디오, 오디오 파일 등

반대로 동적 콘텐츠(Dynamic Content)는 사용자 요청이나 데이터베이스 상태에 따라 서버에서 실시간으로 생성되어 제공되는 내용입니다(예: 사용자의 게시물 목록, 검색 결과 페이지 등). HTML 파일 자체는 서버에서 데이터를 기반으로 렌더링되는 경우가 많아 동적 콘텐츠로 분류될 수도 있고, 내용 변경이 없다면 정적으로 제공될 수도 있습니다.

## 2. 정적 에셋 처리의 중요성

정적 에셋은 웹 페이지 로딩 성능에 큰 영향을 미칩니다. 파일 크기가 크거나 개수가 많으면 페이지 로딩 시간이 길어져 사용자 경험을 저하시킬 수 있습니다. 따라서 정적 에셋을 효율적으로 처리하고 최적화하는 것이 중요합니다:

-   **빠른 로딩 속도:** 최적화된 에셋은 빠르게 다운로드되어 사용자가 페이지를 더 빨리 볼 수 있게 합니다.
-   **서버 부하 감소:** 캐싱을 통해 동일한 에셋 요청이 반복될 때 서버에 다시 요청하지 않으므로 서버 부하를 줄일 수 있습니다.
-   **대역폭 절약:** 파일 크기를 줄이고 캐싱을 활용하여 네트워크 데이터 전송량을 줄입니다.

## 3. 콘텐츠 전송 네트워크 (CDN - Content Delivery Network)란?

CDN은 전 세계 여러 지역에 분산된 서버(엣지 서버, Edge Server) 네트워크를 의미합니다. 웹사이트의 정적 에셋(때로는 동적 콘텐츠까지)을 이 엣지 서버들에 복제하여 저장해 두고, 사용자의 요청이 있을 때 **사용자와 가장 가까운 위치의 엣지 서버**에서 콘텐츠를 전송하는 기술입니다.

**CDN의 작동 원리:**

1.  사용자가 웹사이트에 접속하면, DNS는 사용자와 가장 가까운 CDN 엣지 서버의 IP 주소를 알려줍니다.
2.  사용자의 브라우저는 해당 엣지 서버로 콘텐츠(정적 에셋)를 요청합니다.
3.  엣지 서버에 요청된 콘텐츠의 캐시된 복사본이 있으면 즉시 사용자에게 전송합니다.
4.  만약 캐시된 복사본이 없거나 만료되었다면, 엣지 서버는 원본 서버(Origin Server)에 콘텐츠를 요청하여 받아온 후, 사용자에게 전송하고 자체 캐시에 저장합니다.

**CDN 사용의 이점:**

-   **로딩 속도 향상:** 사용자와 물리적으로 가까운 서버에서 콘텐츠를 받으므로 네트워크 지연 시간(Latency)이 줄어듭니다.
-   **서버 부하 분산:** 트래픽이 여러 엣지 서버로 분산되므로 원본 서버의 부하가 크게 감소합니다.
-   **가용성 및 안정성 향상:** 특정 서버에 장애가 발생해도 다른 서버를 통해 서비스가 가능하며, 트래픽 급증(Spike) 시에도 안정적인 서비스 제공에 도움이 됩니다.
-   **보안 강화:** 많은 CDN 서비스는 DDoS 공격 방어, WAF(웹 애플리케이션 방화벽) 등의 보안 기능을 함께 제공합니다.

## 4. 캐싱 (Caching)의 역할

캐싱은 한 번 접근했던 데이터를 재사용 가능한 형태로 임시 저장해 두었다가, 동일한 요청이 다시 발생했을 때 저장된 데이터를 사용하여 더 빠르게 응답하는 기술입니다. 웹 성능 최적화에서 캐싱은 매우 중요합니다.

**주요 캐싱 계층:**

-   **브라우저 캐시 (Browser Cache):**
    -   사용자의 로컬 컴퓨터(브라우저)에 정적 에셋(CSS, JS, 이미지 등)을 저장합니다.
    -   사용자가 동일한 웹사이트를 다시 방문하면, 네트워크 요청 없이 로컬 캐시에서 에셋을 즉시 로드하여 매우 빠른 로딩 속도를 제공합니다.
    -   서버는 HTTP 응답 헤더(`Cache-Control`, `Expires`, `ETag`, `Last-Modified`)를 통해 브라우저 캐싱 동작(캐시 유효 기간, 재검증 방법 등)을 제어합니다.
-   **CDN 캐시 (CDN Cache):**
    -   CDN 엣지 서버에 원본 서버의 콘텐츠 복사본을 저장합니다.
    -   여러 사용자가 동일한 지역에서 동일한 콘텐츠를 요청할 때, 원본 서버까지 가지 않고 가까운 엣지 서버에서 직접 응답하여 로딩 속도를 개선하고 원본 서버 부하를 줄입니다.
    -   CDN 설정(캐싱 규칙, TTL)을 통해 캐싱 동작을 제어합니다.
-   **서버 캐시 (Server Cache):**
    -   애플리케이션 서버 자체에서 자주 사용되는 데이터나 연산 결과를 메모리(예: Redis, Memcached) 등에 저장하여 데이터베이스 조회나 복잡한 연산을 반복하지 않도록 합니다. (정적 에셋 캐싱과는 다른 개념)

## 5. 캐시 버스팅 (Cache Busting)

-   **정의:** 정적 에셋 파일(CSS, JS 등)의 내용이 변경되었을 때, 브라우저나 CDN이 기존 캐시된 버전 대신 새로운 버전을 확실하게 받아가도록 하는 기법입니다.
-   **방법:** 파일 내용이 변경될 때마다 파일 이름에 고유한 해시(hash)나 버전 번호를 포함시킵니다 (예: `app.a1b2c3d4.js`). 파일 내용이 조금이라도 바뀌면 해시값이 변경되어 파일 이름이 달라지므로, 브라우저나 CDN은 이를 완전히 새로운 파일로 인식하고 새로 다운로드합니다.
-   **이점:** 이 방식을 사용하면 에셋 파일에 대해 매우 긴 캐시 유효 기간(`Cache-Control: max-age=31536000, immutable`)을 설정하여 캐시 효율을 극대화하면서도, 업데이트 시 사용자가 즉시 최신 버전을 받아볼 수 있도록 보장할 수 있습니다. Remix + Vite와 같은 현대적인 빌드 도구는 이 기능을 자동으로 지원합니다.

효과적인 정적 에셋 처리, CDN 활용, 그리고 캐싱 전략은 빠르고 안정적인 웹 서비스를 제공하는 데 필수적인 요소입니다. 