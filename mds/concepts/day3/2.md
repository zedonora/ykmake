# 개념 2: Supabase 클라이언트 설정 및 유틸리티 함수 생성

## Supabase 클라이언트란?

Supabase 클라이언트는 애플리케이션 코드에서 Supabase의 기능(데이터베이스, 인증, 스토리지 등)과 상호작용하기 위한 공식 라이브러리입니다. `@supabase/supabase-js` 패키지를 통해 제공되며, 앞서 설정한 Supabase 프로젝트 URL과 API 키를 사용하여 초기화합니다.

## Remix에서의 클라이언트 설정

Remix 애플리케이션에서는 클라이언트 측(브라우저)과 서버 측(Node.js 환경) 모두에서 Supabase 클라이언트를 사용해야 할 수 있습니다.

*   **서버 측 클라이언트:**
    *   주로 `loader`나 `action` 함수 내에서 데이터를 조회하거나 변경할 때 사용됩니다.
    *   환경 변수에 저장된 `SUPABASE_URL`과 `SUPABASE_SERVICE_ROLE_KEY` (또는 경우에 따라 `SUPABASE_ANON_KEY`)를 사용하여 초기화합니다.
    *   `service_role` 키를 사용하면 RLS(Row Level Security) 정책을 우회하고 모든 데이터에 접근할 수 있으므로, 필요한 경우에만 신중하게 사용해야 합니다.
*   **클라이언트 측 클라이언트:**
    *   주로 사용자 인터랙션에 따라 실시간으로 데이터를 업데이트하거나, 클라이언트 상태 관리에 필요한 최소한의 데이터를 가져올 때 사용될 수 있습니다. (하지만 Remix에서는 가급적 `loader`를 통해 서버에서 데이터를 로드하는 것을 권장합니다.)
    *   환경 변수 `SUPABASE_URL`과 `SUPABASE_ANON_KEY`를 사용하여 초기화합니다. **`service_role` 키는 절대로 클라이언트 측 코드에 노출되어서는 안 됩니다.**
    *   클라이언트 측에서 환경 변수를 사용하기 위해서는 Remix의 특정 설정이 필요합니다. (예: `root.tsx`의 `loader`에서 공개 키를 전달)

## 유틸리티 함수 생성의 이점

Supabase 클라이언트 생성 및 사용하는 로직을 별도의 유틸리티 함수로 분리하면 다음과 같은 이점이 있습니다.

*   **코드 중복 감소:** 여러 `loader`나 `action`에서 클라이언트 초기화 코드를 반복해서 작성할 필요가 없습니다.
*   **중앙 관리:** Supabase 설정 변경(예: API 키 업데이트) 시 유틸리티 함수만 수정하면 되므로 유지보수가 용이합니다.
*   **일관성 유지:** 애플리케이션 전체에서 동일한 방식으로 Supabase 클라이언트를 사용하도록 보장합니다.
*   **테스트 용이성:** Supabase 관련 로직을 격리하여 단위 테스트나 통합 테스트를 더 쉽게 작성할 수 있습니다.

일반적으로 서버 측 클라이언트를 생성하는 함수와, 클라이언트 측에서 사용할 공개 정보를 전달하는 로직을 분리하여 관리합니다.

다음 작업에서는 실제로 `@supabase/supabase-js` 패키지를 설치하고, 서버 측 Supabase 클라이언트를 생성하는 유틸리티 함수를 구현합니다. 